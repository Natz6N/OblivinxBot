/**
 * MessageQueue
 * @license MIT
 * @copyright 2025 Natz
 */





const _0x54a60c=_0x26e7;function _0x26e7(_0x116aa5,_0x56e8eb){const _0x20941d=_0x2094();return _0x26e7=function(_0x26e7b5,_0x3610c3){_0x26e7b5=_0x26e7b5-0x171;let _0x516d4b=_0x20941d[_0x26e7b5];return _0x516d4b;},_0x26e7(_0x116aa5,_0x56e8eb);}function _0x2094(){const _0x11fdc6=['audio','findLowestPriorityMessageIndex','\x0aQueue\x20Status:\x0a-\x20Queue\x20Size:\x20','metadata','registerHandler','\x20after\x20','attempts','\x0a-\x20Currently\x20Processing:\x20','sender','\x20attempts:\x20','shift','\x20messages).\x20Dropping\x20message\x20with\x20lowest\x20priority.','locationMessage','\x20(Attempt:\x20','location','substring','cleanupInterval','maxConcurrentProcessing','videoMessage','OWNER','5LNrGyK','random','rateLimitDelay','.\x20Queue\x20is\x20full\x20and\x20message\x20priority\x20is\x20not\x20high\x20enough.','13531903gKOWZS','1809fIQoWr','No\x20handler\x20for\x20message\x20type:\x20','splice','warn','\x20msg/s\x0a-\x20Highest\x20Queue\x20Length:\x20','race','Default\x20message\x20handler\x20has\x20been\x20set','processingDelay','Retrying\x20message\x20','cleanup','chat','\x0a-\x20Processing\x20Rate:\x20','monitorQueueStatus','isAdmin',',\x20target:\x20','getStatistics','processQueue','toFixed','startsWith','isOwner','maxConcurrent','setDefaultHandler','7035gfbRpe','\x0a-\x20Total\x20Processed:\x20','queue','Cleaned\x20up\x20','size','finally','3541506prbKKs','Handler\x20harus\x20berupa\x20fungsi','Failed\x20to\x20process\x20message\x20','4723767lhoTax','video','function','totalErrors','Duplicate\x20message\x20detected:\x20','\x0a-\x20Total\x20Errors:\x20','priority','306bwwDzY','highestQueueLength','substr','Handler\x20timeout','sort','8457fWUraX','Error\x20processing\x20message\x20','info','catch','Rate\x20limit\x20set\x20for\x20','limit:','cleanupRateLimitTracker','\x0a-\x20Total\x20Received:\x20','...','defaultHandler','Cannot\x20enqueue\x20message:\x20','4713520EMpFXp','isGroup','startTime','rate-overlimit','processMessage','set','totalProcessed','updateRateLimit','includes','timestamp','enqueue','delete','isRateLimited','command','setRateLimit','rateLimitTracker','statistics','processingQueue','text','get','messageHandlers','Default\x20handler\x20harus\x20berupa\x20fungsi','audioMessage','Oblixn','messageText','LOW','sticker','NORMAL','global','ADMIN','isPremium','imageMessage','toString','totalRateLimited','message','delay','rateLimited','Unknown\x20error','msg_','priorityLevels','documentMessage','Registered\x20handler\x20for\x20message\x20type:\x20','document','\x0a\x20\x20\x20\x20','monitorInterval','max','isProcessing','contactMessage','determineMessageType','entries','length','isDuplicateMessage','Rate\x20limit\x20reached\x20for\x20message\x20','Queue\x20is\x20full\x20(','debug','now','\x20with\x20delay\x20','PREMIUM','image','1064uKlCpB','error','determineMessagePriority','totalReceived','maxQueueSize','\x0a-\x20Total\x20Rate\x20Limited:\x20','\x20old\x20entries\x20from\x20rate\x20limit\x20tracker','contact','push','596ITkjKr','stickerMessage'];_0x2094=function(){return _0x11fdc6;};return _0x2094();}(function(_0x3c5498,_0x5707c2){const _0x23f7a4=_0x26e7,_0x1ad547=_0x3c5498();while(!![]){try{const _0x1babcb=parseInt(_0x23f7a4(0x1c2))/0x1*(parseInt(_0x23f7a4(0x1e8))/0x2)+parseInt(_0x23f7a4(0x1ed))/0x3*(-parseInt(_0x23f7a4(0x1a7))/0x4)+parseInt(_0x23f7a4(0x1bd))/0x5*(-parseInt(_0x23f7a4(0x1de))/0x6)+parseInt(_0x23f7a4(0x1d8))/0x7*(-parseInt(_0x23f7a4(0x19e))/0x8)+-parseInt(_0x23f7a4(0x1e1))/0x9+parseInt(_0x23f7a4(0x1f8))/0xa+parseInt(_0x23f7a4(0x1c1))/0xb;if(_0x1babcb===_0x5707c2)break;else _0x1ad547['push'](_0x1ad547['shift']());}catch(_0x20d0a5){_0x1ad547['push'](_0x1ad547['shift']());}}}(_0x2094,0x4b8f4));import{botLogger}from'../bot.js';class MessageQueue{constructor(_0xc9bdb3={}){const _0x4ffc2a=_0x26e7;this[_0x4ffc2a(0x1da)]=[],this[_0x4ffc2a(0x174)]=new Map(),this[_0x4ffc2a(0x1ba)]=_0xc9bdb3[_0x4ffc2a(0x1d6)]||0x19,this[_0x4ffc2a(0x1a2)]=_0xc9bdb3[_0x4ffc2a(0x1a2)]||0x1388,this[_0x4ffc2a(0x1c9)]=_0xc9bdb3[_0x4ffc2a(0x1c9)]||0x32,this[_0x4ffc2a(0x1bf)]=_0xc9bdb3[_0x4ffc2a(0x1bf)]||0xbb8,this[_0x4ffc2a(0x172)]=new Map(),this[_0x4ffc2a(0x18a)]={'OWNER':0x0,'ADMIN':0x1,'PREMIUM':0x2,'NORMAL':0x3,'LOW':0x4},this[_0x4ffc2a(0x191)]=![],this[_0x4ffc2a(0x177)]=new Map(),this[_0x4ffc2a(0x173)]={'totalReceived':0x0,'totalProcessed':0x0,'totalErrors':0x0,'totalRateLimited':0x0,'startTime':Date[_0x4ffc2a(0x19a)](),'highestQueueLength':0x0},this[_0x4ffc2a(0x1f6)]=null,this[_0x4ffc2a(0x18f)]=setInterval(()=>this[_0x4ffc2a(0x1ce)](),0x7530),this[_0x4ffc2a(0x1b9)]=setInterval(()=>this[_0x4ffc2a(0x1f3)](),0xea60);}[_0x54a60c(0x1f3)](){const _0xdfd278=_0x54a60c,_0x47698d=Date[_0xdfd278(0x19a)]();let _0xc0bf37=0x0;for(const [_0x1091c5,_0x429442]of this[_0xdfd278(0x172)][_0xdfd278(0x194)]()){_0x47698d-_0x429442>0xea60&&(this[_0xdfd278(0x172)][_0xdfd278(0x203)](_0x1091c5),_0xc0bf37++);}_0xc0bf37>0x0&&botLogger[_0xdfd278(0x199)](_0xdfd278(0x1db)+_0xc0bf37+_0xdfd278(0x1a4));}[_0x54a60c(0x1ad)](_0x3c6cac,_0x11d520){const _0x4805be=_0x54a60c;if(typeof _0x11d520!==_0x4805be(0x1e3))throw new Error(_0x4805be(0x1df));this[_0x4805be(0x177)][_0x4805be(0x1fd)](_0x3c6cac,_0x11d520),botLogger[_0x4805be(0x1ef)](_0x4805be(0x18c)+_0x3c6cac);}[_0x54a60c(0x1d7)](_0x5ea9df){const _0x4d8d58=_0x54a60c;if(typeof _0x5ea9df!==_0x4d8d58(0x1e3))throw new Error(_0x4d8d58(0x178));this[_0x4d8d58(0x1f6)]=_0x5ea9df,botLogger[_0x4d8d58(0x1ef)](_0x4d8d58(0x1c8));}[_0x54a60c(0x202)](_0x1e8ce7,_0x4cf0df={}){const _0x21aba8=_0x54a60c,_0x45a117=_0x4cf0df['id']||_0x21aba8(0x189)+Date[_0x21aba8(0x19a)]()+'_'+Math[_0x21aba8(0x1be)]()[_0x21aba8(0x183)](0x24)[_0x21aba8(0x1ea)](0x2,0x9);if(_0x1e8ce7[_0x21aba8(0x17b)]&&this[_0x21aba8(0x196)](_0x1e8ce7))return botLogger[_0x21aba8(0x199)](_0x21aba8(0x1e5)+_0x1e8ce7[_0x21aba8(0x17b)][_0x21aba8(0x1b8)](0x0,0x1e)+_0x21aba8(0x1f5)),null;const _0x70b89c=this[_0x21aba8(0x1a0)](_0x1e8ce7,_0x4cf0df),_0x419a29=this[_0x21aba8(0x193)](_0x1e8ce7),_0x107cef={'id':_0x45a117,'message':_0x1e8ce7,'metadata':{..._0x4cf0df,'receivedAt':Date[_0x21aba8(0x19a)](),'priority':_0x70b89c,'messageType':_0x419a29,'attempts':0x0}};if(this[_0x21aba8(0x1da)][_0x21aba8(0x195)]>=this[_0x21aba8(0x1a2)]){botLogger[_0x21aba8(0x1c5)](_0x21aba8(0x198)+this[_0x21aba8(0x1da)][_0x21aba8(0x195)]+_0x21aba8(0x1b4));const _0x3e57e9=this[_0x21aba8(0x1aa)]();if(_0x3e57e9!==-0x1&&this[_0x21aba8(0x1da)][_0x3e57e9][_0x21aba8(0x1ac)][_0x21aba8(0x1e7)]>_0x70b89c)this[_0x21aba8(0x1da)][_0x21aba8(0x1c4)](_0x3e57e9,0x1);else return botLogger[_0x21aba8(0x19f)](_0x21aba8(0x1f7)+_0x45a117+_0x21aba8(0x1c0)),null;}return this[_0x21aba8(0x1da)][_0x21aba8(0x1a6)](_0x107cef),this[_0x21aba8(0x173)][_0x21aba8(0x1a1)]++,this[_0x21aba8(0x173)][_0x21aba8(0x1e9)]=Math[_0x21aba8(0x190)](this[_0x21aba8(0x173)][_0x21aba8(0x1e9)],this[_0x21aba8(0x1da)][_0x21aba8(0x195)]),!this[_0x21aba8(0x191)]&&this[_0x21aba8(0x1d2)](),_0x45a117;}[_0x54a60c(0x196)](_0xfdd441){const _0x2c4179=_0x54a60c;if(!_0xfdd441[_0x2c4179(0x17b)])return![];const _0x4d161a=_0xfdd441[_0x2c4179(0x1b1)]+':'+_0xfdd441[_0x2c4179(0x17b)],_0x4c3782=Date[_0x2c4179(0x19a)](),_0x1de7ed=this[_0x2c4179(0x172)][_0x2c4179(0x176)](_0x4d161a);if(_0x1de7ed&&_0x4c3782-_0x1de7ed<0x1388)return!![];return this[_0x2c4179(0x172)][_0x2c4179(0x1fd)](_0x4d161a,_0x4c3782),![];}[_0x54a60c(0x1a0)](_0x3e08a4,_0x3a882b){const _0x6913d0=_0x54a60c;if(_0x3e08a4[_0x6913d0(0x1b1)]&&global[_0x6913d0(0x17a)]&&global[_0x6913d0(0x17a)][_0x6913d0(0x1d5)]&&global[_0x6913d0(0x17a)][_0x6913d0(0x1d5)](_0x3e08a4[_0x6913d0(0x1b1)]))return this[_0x6913d0(0x18a)][_0x6913d0(0x1bc)];if(_0x3e08a4[_0x6913d0(0x1f9)]&&_0x3e08a4[_0x6913d0(0x1cf)])return this[_0x6913d0(0x18a)][_0x6913d0(0x180)];if(_0x3a882b[_0x6913d0(0x181)])return this[_0x6913d0(0x18a)][_0x6913d0(0x19c)];if(_0x3e08a4[_0x6913d0(0x17b)]&&_0x3e08a4[_0x6913d0(0x17b)][_0x6913d0(0x1d4)]('!'))return this[_0x6913d0(0x18a)][_0x6913d0(0x17e)];return this[_0x6913d0(0x18a)][_0x6913d0(0x17c)];}[_0x54a60c(0x193)](_0x2fcdcb){const _0x5cf16b=_0x54a60c;if(_0x2fcdcb[_0x5cf16b(0x17b)]&&_0x2fcdcb[_0x5cf16b(0x17b)][_0x5cf16b(0x1d4)]('!'))return _0x5cf16b(0x205);if(_0x2fcdcb[_0x5cf16b(0x185)]){if(_0x2fcdcb[_0x5cf16b(0x185)][_0x5cf16b(0x182)])return _0x5cf16b(0x19d);if(_0x2fcdcb[_0x5cf16b(0x185)][_0x5cf16b(0x1bb)])return _0x5cf16b(0x1e2);if(_0x2fcdcb[_0x5cf16b(0x185)][_0x5cf16b(0x179)])return _0x5cf16b(0x1a9);if(_0x2fcdcb[_0x5cf16b(0x185)][_0x5cf16b(0x1a8)])return _0x5cf16b(0x17d);if(_0x2fcdcb[_0x5cf16b(0x185)][_0x5cf16b(0x18b)])return _0x5cf16b(0x18d);if(_0x2fcdcb[_0x5cf16b(0x185)][_0x5cf16b(0x1b5)])return _0x5cf16b(0x1b7);if(_0x2fcdcb[_0x5cf16b(0x185)][_0x5cf16b(0x192)])return _0x5cf16b(0x1a5);}return _0x5cf16b(0x175);}[_0x54a60c(0x1aa)](){const _0x3049f2=_0x54a60c;let _0x410bc5=-0x1,_0x4ffaad=-0x1;for(let _0x56b44e=0x0;_0x56b44e<this[_0x3049f2(0x1da)][_0x3049f2(0x195)];_0x56b44e++){const _0x13bfd6=this[_0x3049f2(0x1da)][_0x56b44e][_0x3049f2(0x1ac)][_0x3049f2(0x1e7)];(_0x410bc5===-0x1||_0x13bfd6>_0x410bc5)&&(_0x410bc5=_0x13bfd6,_0x4ffaad=_0x56b44e);}return _0x4ffaad;}async[_0x54a60c(0x1d2)](){const _0x236598=_0x54a60c;if(this[_0x236598(0x191)])return;this[_0x236598(0x191)]=!![];while(this[_0x236598(0x1da)][_0x236598(0x195)]>0x0){if(this[_0x236598(0x174)][_0x236598(0x1dc)]>=this[_0x236598(0x1ba)]){await new Promise(_0x5866d0=>setTimeout(_0x5866d0,this[_0x236598(0x1c9)]));continue;}this[_0x236598(0x1da)][_0x236598(0x1ec)]((_0x5c6868,_0x271d25)=>_0x5c6868[_0x236598(0x1ac)][_0x236598(0x1e7)]-_0x271d25[_0x236598(0x1ac)][_0x236598(0x1e7)]);const _0x53893f=this[_0x236598(0x1da)][_0x236598(0x1b3)](),_0x105941=_0x53893f[_0x236598(0x185)][_0x236598(0x1cc)]||_0x236598(0x17f);if(this[_0x236598(0x204)](_0x105941)){_0x53893f[_0x236598(0x1ac)][_0x236598(0x1e7)]+=0.5,this[_0x236598(0x1da)][_0x236598(0x1a6)](_0x53893f),await new Promise(_0x136ee6=>setTimeout(_0x136ee6,0xc8));continue;}this[_0x236598(0x1ff)](_0x105941),this[_0x236598(0x174)][_0x236598(0x1fd)](_0x53893f['id'],_0x53893f),this[_0x236598(0x1fc)](_0x53893f)[_0x236598(0x1f0)](_0x5b71ac=>{const _0x208128=_0x236598,_0x69507a=_0x5b71ac[_0x208128(0x185)]||_0x208128(0x188);_0x69507a[_0x208128(0x200)](_0x208128(0x1fb))?(this[_0x208128(0x173)][_0x208128(0x184)]++,botLogger[_0x208128(0x1c5)](_0x208128(0x197)+_0x53893f['id']+_0x208128(0x1d0)+_0x105941),this[_0x208128(0x171)](_0x105941,this[_0x208128(0x1bf)]*0x2),_0x53893f[_0x208128(0x1ac)][_0x208128(0x1af)]<0x3&&(_0x53893f[_0x208128(0x1ac)][_0x208128(0x1af)]++,_0x53893f[_0x208128(0x1ac)][_0x208128(0x1e7)]+=0x1,this[_0x208128(0x1da)][_0x208128(0x1a6)](_0x53893f))):(botLogger[_0x208128(0x19f)](_0x208128(0x1ee)+_0x53893f['id']+':\x20'+_0x69507a),this[_0x208128(0x173)][_0x208128(0x1e4)]++);})[_0x236598(0x1dd)](()=>{const _0x174cdb=_0x236598;this[_0x174cdb(0x174)][_0x174cdb(0x203)](_0x53893f['id']);}),await new Promise(_0x42c395=>setTimeout(_0x42c395,this[_0x236598(0x1c9)]));}this[_0x236598(0x191)]=![];}[_0x54a60c(0x204)](_0x36d4b8){const _0x1550ae=_0x54a60c,_0xb08a16=this[_0x1550ae(0x172)][_0x1550ae(0x176)](_0x1550ae(0x1f2)+_0x36d4b8);if(!_0xb08a16)return![];const _0x2fdb88=Date[_0x1550ae(0x19a)]();return _0x2fdb88-_0xb08a16[_0x1550ae(0x201)]<_0xb08a16[_0x1550ae(0x186)];}[_0x54a60c(0x1ff)](_0x18c541){const _0x43e6eb=_0x54a60c,_0x390c82=Date[_0x43e6eb(0x19a)](),_0x12e1d5=this[_0x43e6eb(0x172)][_0x43e6eb(0x176)](_0x43e6eb(0x1f2)+_0x18c541);this[_0x43e6eb(0x172)][_0x43e6eb(0x1fd)](_0x43e6eb(0x1f2)+_0x18c541,{'timestamp':_0x390c82,'delay':_0x12e1d5&&_0x12e1d5[_0x43e6eb(0x187)]?_0x12e1d5[_0x43e6eb(0x186)]:this[_0x43e6eb(0x1c9)],'rateLimited':![]});}[_0x54a60c(0x171)](_0x36cad0,_0x4f2d83){const _0x1cf6a6=_0x54a60c;this[_0x1cf6a6(0x172)][_0x1cf6a6(0x1fd)](_0x1cf6a6(0x1f2)+_0x36cad0,{'timestamp':Date[_0x1cf6a6(0x19a)](),'delay':_0x4f2d83,'rateLimited':!![]}),botLogger[_0x1cf6a6(0x1c5)](_0x1cf6a6(0x1f1)+_0x36cad0+_0x1cf6a6(0x19b)+_0x4f2d83+'ms');}async[_0x54a60c(0x1fc)](_0x26db1a){const _0x3c5690=_0x54a60c;try{const {message:_0xfc0331,metadata:_0x1b9d24}=_0x26db1a,{messageType:_0x2f38fb}=_0x1b9d24,_0x2d1a9e=this[_0x3c5690(0x177)][_0x3c5690(0x176)](_0x2f38fb)||this[_0x3c5690(0x1f6)];if(!_0x2d1a9e){botLogger[_0x3c5690(0x1c5)](_0x3c5690(0x1c3)+_0x2f38fb);return;}await Promise[_0x3c5690(0x1c7)]([_0x2d1a9e(_0xfc0331,_0x1b9d24),new Promise((_0x13ef79,_0x14e87a)=>setTimeout(()=>_0x14e87a(new Error(_0x3c5690(0x1eb))),0x7530))]),this[_0x3c5690(0x173)][_0x3c5690(0x1fe)]++;}catch(_0x24ce83){_0x26db1a[_0x3c5690(0x1ac)][_0x3c5690(0x1af)]++;_0x26db1a[_0x3c5690(0x1ac)][_0x3c5690(0x1af)]<0x3?(botLogger[_0x3c5690(0x1c5)](_0x3c5690(0x1ca)+_0x26db1a['id']+_0x3c5690(0x1b6)+_0x26db1a[_0x3c5690(0x1ac)][_0x3c5690(0x1af)]+')'),this[_0x3c5690(0x1da)][_0x3c5690(0x1a6)](_0x26db1a)):(botLogger[_0x3c5690(0x19f)](_0x3c5690(0x1e0)+_0x26db1a['id']+_0x3c5690(0x1ae)+_0x26db1a[_0x3c5690(0x1ac)][_0x3c5690(0x1af)]+_0x3c5690(0x1b2)+_0x24ce83[_0x3c5690(0x185)]),this[_0x3c5690(0x173)][_0x3c5690(0x1e4)]++);throw _0x24ce83;}}[_0x54a60c(0x1ce)](){const _0x3db7ba=_0x54a60c,_0x1db662=(Date[_0x3db7ba(0x19a)]()-this[_0x3db7ba(0x173)][_0x3db7ba(0x1fa)])/0x3e8,_0x3cbf5d=this[_0x3db7ba(0x173)][_0x3db7ba(0x1fe)]/_0x1db662;botLogger[_0x3db7ba(0x1ef)](_0x3db7ba(0x1ab)+this[_0x3db7ba(0x1da)][_0x3db7ba(0x195)]+_0x3db7ba(0x1b0)+this[_0x3db7ba(0x174)][_0x3db7ba(0x1dc)]+_0x3db7ba(0x1f4)+this[_0x3db7ba(0x173)][_0x3db7ba(0x1a1)]+_0x3db7ba(0x1d9)+this[_0x3db7ba(0x173)][_0x3db7ba(0x1fe)]+_0x3db7ba(0x1e6)+this[_0x3db7ba(0x173)][_0x3db7ba(0x1e4)]+_0x3db7ba(0x1a3)+this[_0x3db7ba(0x173)][_0x3db7ba(0x184)]+_0x3db7ba(0x1cd)+_0x3cbf5d[_0x3db7ba(0x1d3)](0x2)+_0x3db7ba(0x1c6)+this[_0x3db7ba(0x173)][_0x3db7ba(0x1e9)]+_0x3db7ba(0x18e));}[_0x54a60c(0x1d1)](){const _0x56c38b=_0x54a60c,_0xd61d5b=Date[_0x56c38b(0x19a)](),_0x24ed94=(_0xd61d5b-this[_0x56c38b(0x173)][_0x56c38b(0x1fa)])/0x3e8;return{'uptime':_0x24ed94,'totalReceived':this[_0x56c38b(0x173)][_0x56c38b(0x1a1)],'totalProcessed':this[_0x56c38b(0x173)][_0x56c38b(0x1fe)],'totalErrors':this[_0x56c38b(0x173)][_0x56c38b(0x1e4)],'currentQueueLength':this[_0x56c38b(0x1da)][_0x56c38b(0x195)],'currentlyProcessing':this[_0x56c38b(0x174)][_0x56c38b(0x1dc)],'highestQueueLength':this[_0x56c38b(0x173)][_0x56c38b(0x1e9)]};}[_0x54a60c(0x1cb)](){const _0x310606=_0x54a60c;clearInterval(this[_0x310606(0x18f)]),clearInterval(this[_0x310606(0x1b9)]);}}export default MessageQueue;